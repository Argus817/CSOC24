# Modular Square Root

## Description

In Legendre Symbol we introduced a fast way to determine whether a number is a square root modulo a prime. We can go further: there are algorithms for efficiently calculating such roots. The best one in practice is called Tonelli-Shanks, which gets its funny name from the fact that it was first described by an Italian in the 19th century and rediscovered independently by Daniel Shanks in the 1970s.  

All primes that aren't 2 are of the form $p ≡ 1\ mod\ 4$ or $p ≡ 3\ mod\ 4$, since all odd numbers obey these congruences. As the previous challenge hinted, in the $p ≡ 3\ mod\ 4$ case, a really simple formula for computing square roots can be [derived](https://crypto.stackexchange.com/a/20994) directly from Fermat's little theorem. That leaves us still with the $p ≡ 1\ mod\ 4$ case, so a more general algorithm is required.  

In a congruence of the form $r^2 ≡a\  mod\ p$, Tonelli-Shanks calculates $r$.  

> Tonelli-Shanks doesn't work for composite (non-prime) moduli. Finding square roots modulo composites is computationally equivalent to integer factorization - that is, it's a hard problem.  

The main use-case for this algorithm is finding elliptic curve co-ordinates. Its operation is somewhat complex so we're not going to discuss the details, however, 
implementations are easy to find and Sage has one built-in.  

Find the square root of $a$ modulo the 2048-bit prime $p$. Give the smaller of the two roots as your answer.  

**Challenge files:**  

- [output.txt](./output.txt)

#### Attachments: [`output.txt`](./output.txt)

## Solution

We are given a prime `p` and a number `a` belonging to $F_p$. We are to find the square root of `a` modulo `p`. I did that using the in-built implementation of Tonelli-Shanks Algorithm in SageMath.

Complete solution is given in [`solve.py`](./solve.py).

```bash
$ python3 solve.py
Square roots are 
2362339307683048638327773298580489298932137505520500388338271052053734747862351779647314176817953359071871560041125289919247146074907151612762640868199621186559522068338032600991311882224016021222672243139362180461232646732465848840425458257930887856583379600967761738596782877851318489355679822813155123045705285112099448146426755110160002515592418850432103641815811071548456284263507805589445073657565381850521367969675699760755310784623577076440037747681760302434924932113640061738777601194622244192758024180853916244427254065441962557282572849162772740798989647948645207349737457445440405057156897508368531939120
and
28169512554311284614348161812907461395482195258388583125795498809297226147214152907614055638917789190356917578259717792167302913007927989841763977292434488782635964253677743342038748567333074043589267896292373028724763808006697707070301035339291758998923066001985927788808579330075671953036025191791621915640175242425390397212674797332132801882880223506177201168864920484993546017284338829512010922075018689505381642887042980971582058343875078178836965895987271392081926458392283354971823611423820865651283490761548053384731721391637064349021755899877224522161311561209530712702153163501623531290150340903913036821041
```

## Answer

`2362339307683048638327773298580489298932137505520500388338271052053734747862351779647314176817953359071871560041125289919247146074907151612762640868199621186559522068338032600991311882224016021222672243139362180461232646732465848840425458257930887856583379600967761738596782877851318489355679822813155123045705285112099448146426755110160002515592418850432103641815811071548456284263507805589445073657565381850521367969675699760755310784623577076440037747681760302434924932113640061738777601194622244192758024180853916244427254065441962557282572849162772740798989647948645207349737457445440405057156897508368531939120`
